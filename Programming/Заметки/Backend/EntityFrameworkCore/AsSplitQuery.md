
## **–ß—Ç–æ —ç—Ç–æ —Ç–∞–∫–æ–µ**

AsSplitQuery ‚Äî –º–µ—Ç–æ–¥ –≤ **Entity Framework Core**, –ø–æ–∑–≤–æ–ª—è—é—â–∏–π —É–ø—Ä–∞–≤–ª—è—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏–µ–π –∑–∞–≥—Ä—É–∑–∫–∏ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (Include).

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é EF Core —Å—Ç–∞—Ä–∞–µ—Ç—Å—è –≤—ã–ø–æ–ª–Ω–∏—Ç—å –æ–¥–∏–Ω SQL-–∑–∞–ø—Ä–æ—Å (Single Query) —Å JOIN –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –≤—Å–µ—Ö —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö. –ù–æ —ç—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫:

- **–ö–∞—Ä—Ç–µ–∑–∏–∞–Ω—Å–∫–æ–º—É –≤–∑—Ä—ã–≤—É** (–º–Ω–æ–∂–µ—Å—Ç–≤–æ –¥—É–±–ª–∏—Ä—É—é—â–∏—Ö—Å—è —Å—Ç—Ä–æ–∫ –ø—Ä–∏ —Å–ª–æ–∂–Ω—ã—Ö Include).
    
- –í—ã—Å–æ–∫–æ–π –Ω–∞–≥—Ä—É–∑–∫–µ –Ω–∞ —Å–µ—Ç—å –∏ –ë–î.
    
- –°–ª–æ–∂–Ω–æ—Å—Ç–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏.
    

AsSplitQuery —Ä–µ—à–∞–µ—Ç —ç—Ç—É –ø—Ä–æ–±–ª–µ–º—É, —Ä–∞–∑–¥–µ–ª—è—è –∑–∞–ø—Ä–æ—Å –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ SQL-–∑–∞–ø—Ä–æ—Å–æ–≤.

  

## **–ó–∞—á–µ–º –Ω—É–∂–Ω–æ**

‚úÖ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ AsSplitQuery:

- –£–º–µ–Ω—å—à–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥—É–±–ª–∏—Ä—É—é—â–∏—Ö—Å—è —Å—Ç—Ä–æ–∫.
    
- –î–µ–ª–∞–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –ø—Ä–æ—â–µ –∏ –±—ã—Å—Ç—Ä–µ–µ –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏—è—Ö.
    
- –£–¥–æ–±–Ω–æ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –¥–∞–Ω–Ω—ã—Ö —Å –º–Ω–æ–∂–µ—Å—Ç–≤–æ–º Include.
    

‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:

- –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –≤–º–µ—Å—Ç–æ –æ–¥–Ω–æ–≥–æ.
    
- –ú–æ–∂–µ—Ç –±—ã—Ç—å –¥–æ—Ä–æ–∂–µ, –µ—Å–ª–∏ —Å–µ—Ç–µ–≤—ã–µ –∑–∞–¥–µ—Ä–∂–∫–∏ –∫—Ä–∏—Ç–∏—á–Ω—ã.
    

## **–ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å**


### **1. –ü—Ä–∏–º–µ—Ä –±–µ–∑¬†AsSplitQuery(Single Query)**

``` csharp
var orders = await context.Orders
    .Include(o => o.Customer)
    .Include(o => o.OrderItems)
        .ThenInclude(oi => oi.Product)
    .ToListAsync();
```

üëâ SQL –±—É–¥–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å JOIN –Ω–∞ –≤—Å–µ —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã. –ï—Å–ª–∏ —É –∑–∞–∫–∞–∑–∞ 10 —Ç–æ–≤–∞—Ä–æ–≤, –¥–∞–Ω–Ω—ã–µ –∑–∞–∫–∞–∑–∞ –∏ –ø–æ–∫—É–ø–∞—Ç–µ–ª—è –±—É–¥—É—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞—Ç—å—Å—è 10 —Ä–∞–∑.

  
### **2. –ü—Ä–∏–º–µ—Ä —Å¬†AsSplitQuery**

``` csharp
var orders = await context.Orders
    .Include(o => o.Customer)
    .Include(o => o.OrderItems)
        .ThenInclude(oi => oi.Product)
    .AsSplitQuery()
    .ToListAsync();
```

üëâ EF Core —Ä–∞–∑–æ–±—å—ë—Ç –∑–∞–ø—Ä–æ—Å –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ:

``` sql
SELECT * FROM Orders;
SELECT * FROM Customers WHERE Id IN (...);
SELECT * FROM OrderItems WHERE OrderId IN (...);
SELECT * FROM Products WHERE Id IN (...);
```

### **–ì–ª–æ–±–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞**


–ú–æ–∂–Ω–æ –∑–∞–¥–∞—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:

``` csharp
optionsBuilder.UseSqlServer(connectionString, 
    o => o.UseQuerySplittingBehavior(QuerySplittingBehavior.SplitQuery));
```

–ò–ª–∏ —á–µ—Ä–µ–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç:

``` csharp
protected override void OnConfiguring(DbContextOptionsBuilder optionsBuilder)
{
    optionsBuilder.UseQuerySplittingBehavior(QuerySplittingBehavior.SplitQuery);
}
```

## **–ö–æ–≥–¥–∞ –ø—Ä–∏–º–µ–Ω—è—Ç—å**

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ AsSplitQuery, –µ—Å–ª–∏:

- –£ –≤–∞—Å –º–Ω–æ–≥–æ Include.
    
- –ï—Å—Ç—å —Ä–∏—Å–∫ –∫–∞—Ä—Ç–µ–∑–∏–∞–Ω—Å–∫–æ–≥–æ –≤–∑—Ä—ã–≤–∞.
    
- –ù—É–∂–Ω–æ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –Ω–∞–≥—Ä—É–∑–∫—É –Ω–∞ –ë–î.
    

–ù–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ, –µ—Å–ª–∏:

- –ó–∞–ø—Ä–æ—Å—ã –¥–æ–ª–∂–Ω—ã –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è —Å—Ç—Ä–æ–≥–æ –æ–¥–Ω–∏–º SQL.
    
- –í–∞–∂–Ω–∞ –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ SQL-–∑–∞–ø—Ä–æ—Å–æ–≤.
    

## **–°—Ä–∞–≤–Ω–µ–Ω–∏–µ**


### **1. Single Query (–±–µ–∑¬†AsSplitQuery)**

- –û–¥–∏–Ω SQL-–∑–∞–ø—Ä–æ—Å.
    
- –í–æ–∑–º–æ–∂–Ω—ã –¥—É–±–ª–∏–∫–∞—Ç—ã –∏ —Ç—è–∂—ë–ª—ã–π JOIN.
    

### **2. Split Query (—Å¬†AsSplitQuery)**

- –ù–µ—Å–∫–æ–ª—å–∫–æ SQL-–∑–∞–ø—Ä–æ—Å–æ–≤.
    
- –ù–µ—Ç –∫–∞—Ä—Ç–µ–∑–∏–∞–Ω—Å–∫–æ–≥–æ –≤–∑—Ä—ã–≤–∞, –Ω–æ –±–æ–ª—å—à–µ round-trip‚Äô–æ–≤ –∫ –ë–î.
    

## **–í—ã–≤–æ–¥**

- AsSplitQuery ‚Äî –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ —Å Include.
    
- –ü–æ–ª–µ–∑–µ–Ω –ø—Ä–∏ —Å–ª–æ–∂–Ω—ã—Ö —Å–≤—è–∑—è—Ö –∏ –±–æ–ª—å—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö.
    
- –ù—É–∂–Ω–æ –≤—ã–±–∏—Ä–∞—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å—Ü–µ–Ω–∞—Ä–∏—è: SingleQuery (–º–µ–Ω—å—à–µ –∑–∞–ø—Ä–æ—Å–æ–≤) –∏–ª–∏ SplitQuery (–º–µ–Ω—å—à–µ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤).
    
- –ì–∏–±–∫–æ—Å—Ç—å: –º–æ–∂–Ω–æ —É–∫–∞–∑—ã–≤–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ (.AsSplitQuery()) –∏–ª–∏ –≥–ª–æ–±–∞–ª—å–Ω–æ (—á–µ—Ä–µ–∑ UseQuerySplittingBehavior).