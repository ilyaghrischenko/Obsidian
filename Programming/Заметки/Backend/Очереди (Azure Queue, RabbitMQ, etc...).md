## **Что такое очередь?**

  

Очередь — структура данных FIFO (First In, First Out), где сообщения ставятся в очередь и обрабатываются по очереди.

  

В программировании — это посредник между компонентами для:

- Асинхронного обмена данными
    
- Разгрузки основного приложения
    
- Гарантированной доставки сообщений
    
- Сглаживания пиков нагрузки
    
- Надежной обработки фоновых задач
    

---

## **Преимущества очередей**

- Асинхронность (отправитель не ждёт обработки)
    
- Отделение компонентов по времени
    
- Масштабируемость обработчиков
    
- Надёжность (сообщения не теряются)
    
- Регулирование нагрузки
    

---

## **Когда использовать очередь?**

- Долгие операции (отправка email, генерация отчётов)
    
- Пиковая нагрузка
    
- Связывание микросервисов
    
- Гарантированная доставка
    
- Повторные попытки при ошибках
    

---

## **Что лучше: API или очередь?**

|**Сценарий**|**Использовать**|**Почему**|
|---|---|---|
|Быстрая обработка запроса|API Endpoint|Пользователь ждёт ответ|
|Долгие операции|Очередь + фоновые задачи|Отделение долгих задач от запроса|
|Пиковая нагрузка|Очередь|Сглаживание нагрузки|
|Надёжная доставка|Очередь|Сообщения не потеряются|
|Интеграция сервисов|Очередь|Асинхронное взаимодействие|

---

## **Azure Functions и очереди**

- Функция с **QueueTrigger** вызывается при новом сообщении в очереди
    
- API кладёт сообщение в очередь
    
- Функция обрабатывает сообщение асинхронно


``` csharp
public sealed class QueueFunction
{
    [Function("QueueFunction")]
    public void Run([QueueTrigger("myqueue", Connection = "AzureWebJobsStorage")] string message)
    {
        // обработка
    }
}
```

---

## **Что класть в очередь?**

- JSON-объекты с данными
    
- Инструкции, задачи, события
    
- Минимальные данные для загрузки деталей из базы
    

---

## **Рекомендации**

- Используй минимальные структуры
    
- Включай только необходимые поля
    
- Добавляй метаданные при необходимости
    
- Версионируй формат сообщений
    

---

## **Итог**

  

Очереди — для асинхронных, масштабируемых, отказоустойчивых решений.

Подходят для:

- Длительных задач
    
- Пиковых нагрузок
    
- Интеграции сервисов